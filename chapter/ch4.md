# Ch4. 전문가다운 C++ 프로그램 디자인

프로그램 디자인의 정의/중요성, C++에 적합한 디자인 고려사항, 추상화와 재사용성 그리고 오픈소스 라이브러리에 대해 다룬다.

## 프로그램 디자인

프로그램 디자인 정의
- 기능 요구사항 (i.e., TODOs)와 비기능 요구사항 (i.e., 동작, 속성)을 만족하는 프로그램을 구현하기 위한 명세서

C++에 적합한 디자인을 위한 특성
- c++에서 제공하는 기능은 방대함 (연산자 오버로딩, 익셉션, 템플릿 등)
- 객체지향 언어이다.
- 범용성과 재사용성을 높이는데 필요한 기능을 다양하게 제공함 (클래스 상속, 템플릿, 연산자 오버로딩)
- 표준 라이브러리르 제공함
- 다양한 디자인 패턴을 적용하여 문제를 해결하기 좋은 구조이다.

## 추상화 (Abstraction)
| 내부 구현 방식을 이해하지 않아도 코드를 사용할 수 있다.

- 추상화를 적용한 디자인 예제 

    ```
    /* 추상화 적용 x */
    ChessPiece* chessBoard[8][8];
    chessBoard[0][0] = new Rock();
    ```

    ```
    /* 추상화 적용 o */
    class ChessBoard 
    {
        public:
            void setPieceAt(size_t x, size_t y, ChessPiece* piece);
            ChessPiece* getPieceAt(size_t x, size_t y);
            bool isEmpty(size_t x, size_t y);

    }

    ```

## 재사용성
| 기존 코드를 활용한다. 기존 코드가 있다면 이를 재사용할 수 있는지 반드시 검토한다 

재사용 가능한 코드 만들기 (템플릿)

- **템플릿**을 활용한 제네릭 클래스 생성 
    ```
    template <typename PieceType>
    class GameBoard
    {
        public:
            void setPieceAt(size_t x, size_t y, PieceType* piece);
            PieceType* getPieceAt(size_t x, size_t y);
            bool isEmpty(size_t x, size_t y);

    }

    ```

디자인 재사용
- 디자인 기법과 패턴 (28 , 29장 참고)

코드 재사용 형식
- 독립함수 또는 클래스 : 본인 또는 동료가 생성한 대부분의 코드
- 라이브러리 : **특정한 작업**을 처리하는데 필요한 코드를 한 데 묶은 것
- 프레임워크 : 디자인할 프로그램의 **기반**이 되는 코드를 모아 둔 것
- API : 특정 기능을 수행하는 코드나 라이브러리에 대한 **인터페이스**


코드 재사용의 장점  
- 개발시간 단축
- 디자인 과정이 간결해짐
- 대부분 디버깅이 필요 없음 (안정성 확보)
- 라이브러리는 다양한 에러 상황에 잘 대응할 수 있도록 디자인 됨.
- 대부분 전문가들이 작성한 코드여서 더 안정적임.
- 라이브러리는 지속적으로 개선됨.

코드 재사용의 단점
- 다른 사람이 작성한 코드/라이브러리는 정확히 어떤 방식으로 동작하는 지 이해하는데 시간이 오래 걸림
- 코드 수정이 유연하지 않음. (정확히 원하는 기능이 없을 경우 난처함)
- 유지보수 문제
- 라이선스 문제
- 크로스 플랫폼 호환성 문제
- 버전 의존성 문제 

코드 재사용 판단 기준 
- 언제든지 결정을 뒤집어도 된다는 것! 프로그램을 제대로 추상화 했다면 결정을 바꾸더라도 큰 부담없이 대응할 수 있다.

코드 재사용 전략
- 멀티 쓰레드 동작 안정성 파악
- 컴파일러 특별히 설정할 게 있는지 파악
- 초기화/종료시 특별히 수행할 게 있는지 파악
- 메모리 포인터 리턴할 때 메모리 해제 작업을 호출한 코드와 라이브러리 중 어느 쪽이 책임져야 하는지 파악
- 라이브러리 사용시 어떤 에러 조건을 확인해야 하는지 파악 
- 서드 파티 애플리케이션을 번들로 제공하는 전략
- 프로토타입을 만들어서 간단히 테스트
